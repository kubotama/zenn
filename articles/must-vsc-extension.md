---
title: "ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã®ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹VSCodeã®æ‹¡å¼µæ©Ÿèƒ½"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [VSCode]
published: false
---

## æ¦‚è¦

Markdown ãªã©ã®ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—è¨€èªã§ Web ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’ä½œã‚‹å ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã§ä½œã‚Šã¾ã™ã€‚

1. ãƒªãƒ³ã‚¯ã‚’ä½œã‚‹ URL ã‚’æ±ºã‚ã‚‹ã€‚
1. URL ã® Web ãƒšãƒ¼ã‚¸ã‚’é–‹ãã€‚
1. é–‹ã„ãŸ Web ãƒšãƒ¼ã‚¸ã‹ã‚‰ F12 ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚
1. title ã‚¿ã‚°ã‚’æ¤œç´¢ã—ã¦ã€ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã‚’é¸æŠã€ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚
1. æœ€åˆã«æ±ºã‚ãŸ URL ã¨ã‚³ãƒ”ãƒ¼ã—ãŸã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã§ãƒªãƒ³ã‚¯ã‚’ä½œã‚‹ã€‚

ã“ã‚Œã‚‰ã®æ‰‹é †+Î± ã«å¯¾å¿œã—ãŸ VSCode ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚+Î± ã¨ã¯ä»¥ä¸‹ã®æ©Ÿèƒ½ã§ã™ã€‚

1. ã‚¿ã‚¤ãƒˆãƒ«ã®å‰å¾Œã®ã‚µã‚¤ãƒˆåãªã©ã‚’å‰Šé™¤ã™ã‚‹ã€‚
1. URL ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‚¢ã‚¯ã‚»ã‚¹çµŒè·¯ã®é›†è¨ˆãªã©ã®ãŸã‚ã®ãƒ•ãƒ©ã‚°ãªã©ã‚’å‰Šé™¤ã™ã‚‹ã€‚

å…·ä½“çš„ãªä¾‹ã§èª¬æ˜ã—ã¾ã™ã€‚

ãŸã¨ãˆã°ã€`https://xtech.nikkei.com/atcl/nxt/column/18/00849/00081/?n_cid=nbpnxt_mled_itmh` ã¨ã„ã† URL ã‚’é¸æŠã—ã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆã‹ã‚‰`Must: Format Link from URL`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€é¸æŠã•ã‚Œã¦ã„ã‚‹ URL ã¯ä»¥ä¸‹ã®æ–‡å­—åˆ—ã«ç½®ãæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚

```markdown
[ã€ŒIE çµ‚äº†ã§ã‚‚ IE ãƒ¢ãƒ¼ãƒ‰ã§å¤§ä¸ˆå¤«ã€ã¯æœ¬å½“ã‹ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ç§»è¡Œã®å…ˆé€ã‚Šã§è¨ªã‚Œã‚‹æ‚²åŠ‡](https://xtech.nikkei.com/atcl/nxt/column/18/00849/00081/)
```

### çµæœ

> [ã€ŒIE çµ‚äº†ã§ã‚‚ IE ãƒ¢ãƒ¼ãƒ‰ã§å¤§ä¸ˆå¤«ã€ã¯æœ¬å½“ã‹ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ç§»è¡Œã®å…ˆé€ã‚Šã§è¨ªã‚Œã‚‹æ‚²åŠ‡](https://xtech.nikkei.com/atcl/nxt/column/18/00849/00081/)

### +Î± æ©Ÿèƒ½ãã® 1: URL ã®æ•´å½¢

ã“ã® URL ã®?ä»¥é™ã¯ãªãã¦ã‚‚åŒã˜ web ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ãªã®ã§ã€ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹ URL æ–‡å­—åˆ—ã‚’`https://xtech.nikkei.com/atcl/nxt/column/18/00849/00081/`ã¨ã—ã¾ã™ã€‚

### +Î± æ©Ÿèƒ½ãã® 2: ã‚¿ã‚¤ãƒˆãƒ«ã®æ•´å½¢

ã“ã® URL ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã€`<title></title>`ã‚¿ã‚°ã‹ã‚‰ã€ã‚¿ã‚¤ãƒˆãƒ«ãŒ` ã€ŒIE çµ‚äº†ã§ã‚‚ IE ãƒ¢ãƒ¼ãƒ‰ã§å¤§ä¸ˆå¤«ã€ã¯æœ¬å½“ã‹ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ç§»è¡Œã®å…ˆé€ã‚Šã§è¨ªã‚Œã‚‹æ‚²åŠ‡ | æ—¥çµŒã‚¯ãƒ­ã‚¹ãƒ†ãƒƒã‚¯ï¼ˆxTECHï¼‰`ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ã‚¿ã‚¤ãƒˆãƒ«ã®æœ€å¾Œã®` | æ—¥çµŒã‚¯ãƒ­ã‚¹ãƒ†ãƒƒã‚¯ï¼ˆxTECHï¼‰`ã¯ã‚µã‚¤ãƒˆåã§ã‚ã‚Šã€ãƒªãƒ³ã‚¯ã®è¦‹å‡ºã—ã«å«ã‚ãªã„ã“ã¨ã«ã™ã‚‹ã¨ã€ãƒªãƒ³ã‚¯ã‚’ä½œæˆã™ã‚‹ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã¯`ã€ŒIEçµ‚äº†ã§ã‚‚IEãƒ¢ãƒ¼ãƒ‰ã§å¤§ä¸ˆå¤«ã€ã¯æœ¬å½“ã‹ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ç§»è¡Œã®å…ˆé€ã‚Šã§è¨ªã‚Œã‚‹æ‚²åŠ‡`ã¨ãªã‚Šã¾ã™ã€‚

URL æ–‡å­—åˆ—ã¨ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ä¸Šè¨˜ã®ãƒªãƒ³ã‚¯ãŒä½œæˆã§ãã¾ã™ã€‚

## ãƒªãƒã‚¸ãƒˆãƒª

[kubotama/must-vscode: markup language support tool of Visual Studio Code extension](https://github.com/kubotama/must-vscode)

## å°å…¥ç’°å¢ƒ

ä»¥ä¸‹ã®ç’°å¢ƒã§ã‚ã‚Œã°å°å…¥å¯èƒ½ã ã¨æ€ã„ã¾ã™ã€‚Linux(Ubuntu 20.04.4 LTS)ã§é–‹ç™ºãŠã‚ˆã³æ¤œè¨¼ã—ã¦ã„ã¾ã™ã€‚

- node.js: V16.15.1
- VScode: 1.68.1

## å°å…¥æ‰‹é †

1. ä¸Šè¨˜ GitHub ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’é©å½“ãªãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚

```sh
$ git clone git@github.com:kubotama/must-vscode.git
```

2. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

```sh
$ yarn
```

3. æ‹¡å¼µæ©Ÿèƒ½ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh
$ npx vsce package
```

4. ä½œæˆã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚æ‹¡å¼µæ©Ÿèƒ½ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒVSIX ã‹ã‚‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«...ã€ã‚’é¸æŠã—ã¦ã€ä½œæˆã•ã‚ŒãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«(must-vscode-X.Y.Z.vsix)ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

## åˆ©ç”¨æ–¹æ³•

1. Markdown ãƒ•ã‚¡ã‚¤ãƒ«(README.md ãªã©)ã§ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ãŸã„ URL ã‚’é¸æŠã—ã¾ã™ã€‚

1. ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆã‹ã‚‰ Must: Format Link from URL ã‚³ãƒãƒ³ãƒ‰ã‚’é¸æŠã—ã¦ã€å®Ÿè¡Œã—ã¾ã™ã€‚

1. é¸æŠã•ã‚Œã¦ã„ã‚‹ URL ãŒãƒªãƒ³ã‚¯ã«ç½®ãæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚

## è¨­å®šæ–¹æ³•

settings.json ãªã©ã«è¨­å®šãŒå¯èƒ½ã§ã™ã€‚

- è¨€èªã”ã¨ã®ãƒªãƒ³ã‚¯å½¢å¼ã®æŒ‡å®š
- ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æŒ‡å®š
- URL ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æŒ‡å®š

### è¨€èªã”ã¨ã®ãƒªãƒ³ã‚¯å½¢å¼ã®æŒ‡å®š (Must-vscode: Link Formats: must-vscode.linkFormats)

è¨€èªã”ã¨ã«ãƒªãƒ³ã‚¯å½¢å¼ã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ Markdown ã®ãƒªãƒ³ã‚¯å½¢å¼ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

```json
{
  "languageId": "markdown",
  "format": "[${title}](${url})"
}
```

languageId å±æ€§ã¯ [Visual Studio Code language identifiers](https://code.visualstudio.com/docs/languages/identifiers#_known-language-identifiers) ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ identifiers ã‚’æŒ‡å®šã—ã¾ã™ã€‚format å±æ€§ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹${title}ãŒã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã€${url}ãŒ URL ã«ç½®ãæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚

ãŸã¨ãˆã°ä»¥ä¸‹ã®æŒ‡å®šã‚’è¿½åŠ ã™ã‚‹ã¨ã€LaTeX ãƒ•ã‚¡ã‚¤ãƒ«ã§é©åˆ‡ãªãƒªãƒ³ã‚¯ãŒä½œæˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```json
{
  "languageId": "latex",
  "format": "\\href{${url}}{${title}}"
}
```

### ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æŒ‡å®š (Must-vscode: Url Patterns: must-vscode.titlePatterns)

ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

- Qiita
- æ—¥çµŒã‚¯ãƒ­ã‚¹ãƒ†ãƒƒã‚¯
- GitHub

```json
{
  "url": "https://qiita.com/",
  "pattern": "(.*) - Qiita",
  "format": "$1"
},
{
  "url": "https://xtech.nikkei.com/.*",
  "pattern": "(.*) \\| æ—¥çµŒã‚¯ãƒ­ã‚¹ãƒ†ãƒƒã‚¯ï¼ˆxTECHï¼‰",
  "format": "$1"
},
{
  "url": "https://github.com/.*",
  "pattern": "GitHub - (.*)",
  "format": "$1"
}
```

url å±æ€§ã¨ä¸€è‡´ã™ã‚‹ web ã‚µã‚¤ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å®šç¾©ã—ã¾ã™ã€‚replace ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç¬¬ä¸€å¼•æ•°ã‚’ pattern å±æ€§ã€ç¬¬äºŒå¼•æ•°ã‚’ format å±æ€§ã§å‘¼ã³å‡ºã—ã¦ã€ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—åˆ—ã‚’ç½®ãæ›¿ãˆã¾ã™ã€‚

### URL ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æŒ‡å®š

URL ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã® URL ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

-æ—¥çµŒã‚¯ãƒ­ã‚¹ãƒ†ãƒƒã‚¯

```json
{
  "url": "(https://xtech.nikkei.com/.*)\\?.*",
  "format": "$1"
}
```

url å±æ€§ã¨ä¸€è‡´ã™ã‚‹ web ã‚µã‚¤ãƒˆã® URL æ–‡å­—åˆ—ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å®šç¾©ã—ã¾ã™ã€‚replace ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç¬¬ä¸€å¼•æ•°ã‚’ url å±æ€§ã€ç¬¬äºŒå¼•æ•°ã‚’ format å±æ€§ã§ã§å‘¼ã³å‡ºã—ã¦ã€URL æ–‡å­—åˆ—ã‚’ç½®ãæ›¿ãˆã¾ã™ã€‚

## ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®èª¬æ˜

1. ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¨ãƒ‡ã‚£ã‚¿ã®è¨€èªã‚’å–å¾—ã—ã¾ã™ã€‚

```typescript
import * as vscode from "vscode";

const editor = vscode.window.activeTextEditor;
const languageId = editor.document.languageId;
```

2. è¨­å®šã‹ã‚‰ãƒªãƒ³ã‚¯ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚

```typescript
const config = vscode.workspace.getConfiguration("must-vscode");
const linkFormats: { languageId: string; format: string }[] | undefined =
  config.get("linkFormats");
const linkFormat = linkFormats.find(
  (linkFormat) => linkFormat.languageId === languageId
);

if (linkFormat) {
  return linkFormat.format;
}
```

3. é¸æŠã•ã‚Œã¦ã„ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ(=URL)ã‚’å–å¾—ã—ã¾ã™ã€‚

```typescript
const selection = editor.selection;
const selectedText = editor.document.getText(selection);
```

4. URL ã‹ã‚‰ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—ã—ã¾ã™ã€‚axios.get ã§å–å¾—ã—ãŸ HTML ã‚³ãƒ¼ãƒ‰ã‚’ JSDOM ã«èª­ã¿è¾¼ã¾ã›ã¦ title å±æ€§ã‚’å–å¾—ã—ã¾ã™ã€‚

```typescript
const response = await axios.get(url);
const dom = new JSDOM(response.data);
const title = dom.window.document.title;
```

5. ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ•´å½¢ã—ã¾ã™ã€‚titleInfo ã¯ã€è¨­å®šã‹ã‚‰å–å¾—ã—ãŸã‚¿ã‚¤ãƒˆãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®é…åˆ—ã§ã™ã€‚URL ã«è©²å½“ã™ã‚‹ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚Œã°ã€ãã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«æ•´å½¢ã—ã¾ã™ã€‚ãªã‘ã‚Œã°ã€ãã®ã¾ã¾ã¨ã—ã¾ã™ã€‚

```typescript
const pattern = titleInfo.titlePatterns.find((pattern) => {
  const reUrl = new RegExp(pattern.url);
  return reUrl.test(titleInfo.url);
});
if (pattern) {
  const rePattern = new RegExp(pattern.pattern);
  return titleInfo.title.replace(rePattern, pattern.format);
}
```

6. URL ã‚’æ•´å½¢ã—ã¾ã™ã€‚urlPatterns ã¯ã€è¨­å®šã‹ã‚‰å–å¾—ã—ãŸ URL ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®é…åˆ—ã§ã™ã€‚URL ã«è©²å½“ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚Œã°ã€ãã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«æ•´å½¢ã—ã¾ã™ã€‚ãªã‘ã‚Œã°ã€ãã®ã¾ã¾ã¨ã—ã¾ã™ã€‚

```typescript
const urlPattern = urlPatterns.find((urlPattern) => {
  const reUrl = new RegExp(urlPattern.url);
  return reUrl.test(url);
});
if (urlPattern) {
  const formatUrl = urlPattern.format;
  const reUrl = new RegExp(urlPattern.url);
  const displayUrl = url.replace(reUrl, formatUrl);
  return displayUrl;
}
```

7. è¨€èªã”ã¨ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¾ã™ã€‚

```typescript
const linkText = format
  .replace("${title}", displayTitle)
  .replace("${url}", url);
return linkText;
```

8. ä½œæˆã—ãŸãƒªãƒ³ã‚¯ã§é¸æŠã•ã‚Œã¦ã„ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’ç½®ãæ›¿ãˆã¾ã™ã€‚
